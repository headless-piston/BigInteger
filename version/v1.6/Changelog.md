全部推倒重写。  
实现了动态内存，包括动态预处理单位根。加入了非法输入的检查。  